<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrome æ“´å……åŠŸèƒ½ç®¡ç†å™¨ - æ¼”ç¤ºä»‹é¢</title>
    <style>
        :root {
            /* Monokai Dark Theme (Default) */
            --bg-primary: #272822;
            --bg-secondary: #3e3d32;
            --bg-tertiary: #49483e;
            --text-primary: #f8f8f2;
            --text-secondary: #75715e;
            --text-accent: #a6e22e;
            --border-color: #49483e;
            --accent-color: #66d9ef;
            --warning-color: #f92672;
            --success-color: #a6e22e;
            --card-bg: #3e3d32;
            --sidebar-bg: #2f2f23;
            --header-bg: #1e1f1c;
        }

        [data-theme="light"] {
            /* Light Theme */
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #fafbfc;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --text-accent: #3498db;
            --border-color: #e0e6ed;
            --accent-color: #3498db;
            --warning-color: #e74c3c;
            --success-color: #27ae60;
            --card-bg: #ffffff;
            --sidebar-bg: #fafbfc;
            --header-bg: #2c3e50;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            min-height: 100vh;
            background: var(--bg-secondary);
            display: flex;
            flex-direction: column;
        }

        /* é ‚éƒ¨å°èˆª */
        .header {
            background: var(--header-bg);
            padding: 16px 24px;
            color: var(--text-primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .nav-btn {
            padding: 10px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .nav-btn:hover {
            background: var(--accent-color);
            color: var(--bg-primary);
        }

        .nav-btn.active {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        /* ä¸»å…§å®¹å€ */
        .main-content {
            display: flex;
            flex: 1;
            min-height: 0;
        }

        /* å·¦å´é‚Šæ¬„ */
        .sidebar {
            min-width: 280px;
            width: 280px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 24px;
            overflow-y: auto;
            flex-shrink: 0;
        }

        @media (max-width: 1024px) {
            .sidebar {
                min-width: 240px;
                width: 240px;
                padding: 20px;
            }
        }

        .sidebar h3 {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 16px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .group-list {
            list-style: none;
        }

        .group-item {
            padding: 14px 16px;
            margin-bottom: 6px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            color: var(--text-primary);
        }

        .group-item:hover {
            border-color: var(--accent-color);
            box-shadow: 0 2px 8px rgba(102, 217, 239, 0.2);
        }

        .group-item.active {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        .group-item .count {
            background: var(--bg-tertiary);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            color: var(--text-secondary);
            min-width: 24px;
            text-align: center;
        }

        .group-item.active .count {
            background: rgba(0, 0, 0, 0.2);
            color: var(--bg-primary);
        }

        .add-group-btn {
            width: 100%;
            padding: 12px;
            background: var(--card-bg);
            border: 2px dashed var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .add-group-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        /* ä¸­é–“å…§å®¹å€ */
        .content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            background: var(--bg-primary);
            min-width: 0;
        }

        @media (max-width: 1024px) {
            .content {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                min-width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }
            
            .content {
                padding: 16px;
            }
        }

        /* æœå°‹å’Œéæ¿¾æ¬„ */
        .toolbar {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            align-items: center;
            padding: 16px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .toolbar {
                gap: 8px;
                padding: 12px;
                flex-direction: column;
                align-items: stretch;
            }
        }

        .search-box {
            flex: 1;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background: var(--card-bg);
            color: var(--text-primary);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(102, 217, 239, 0.2);
        }

        .search-box input::placeholder {
            color: var(--text-secondary);
        }

        .search-box::after {
            content: "ğŸ”";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
        }

        .filter-btn, .action-btn {
            padding: 12px 16px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .filter-btn:hover, .action-btn:hover {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .action-btn.primary {
            background: var(--accent-color);
            color: var(--bg-primary);
            border-color: var(--accent-color);
        }

        .action-btn.primary:hover {
            opacity: 0.9;
        }

        .action-btn.danger {
            background: var(--warning-color);
            color: var(--text-primary);
            border-color: var(--warning-color);
        }

        .action-btn.danger:hover {
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .filter-btn, .action-btn {
                padding: 10px 12px;
                font-size: 13px;
            }
        }

        /* æ“´å……åŠŸèƒ½å¡ç‰‡ - éŸ¿æ‡‰å¼ç¶²æ ¼ */
        .extensions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        @media (min-width: 1400px) {
            .extensions-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 1200px) {
            .extensions-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 14px;
            }
        }

        @media (max-width: 900px) {
            .extensions-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
        }

        @media (max-width: 600px) {
            .extensions-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
        }

        .extension-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
            transition: all 0.2s;
            cursor: grab;
            width: 100%;
            aspect-ratio: 5 / 4;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .extension-card:hover {
            box-shadow: 0 4px 12px rgba(102, 217, 239, 0.3);
            border-color: var(--accent-color);
        }

        .extension-card.dragging {
            opacity: 0.6;
            cursor: grabbing;
            transform: scale(0.98);
        }

        .extension-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .extension-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            font-size: 20px;
            flex-shrink: 0;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
        }

        .extension-icon img {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            object-fit: cover;
        }

        .extension-info {
            flex: 1;
            min-width: 0;
        }

        .extension-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--text-primary);
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .extension-meta {
            font-size: 11px;
            color: var(--text-secondary);
            line-height: 1.2;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .extension-description {
            font-size: 12px;
            color: var(--text-primary);
            line-height: 1.3;
            margin-bottom: 12px;
            flex: 1;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            cursor: text;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .extension-description:hover {
            background: var(--bg-tertiary);
        }

        .extension-description.editing {
            background: var(--bg-secondary);
            border: 1px solid var(--accent-color);
            outline: none;
        }

        .extension-toggle {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 44px;
            height: 22px;
        }

        .toggle-switch {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--text-secondary);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-switch.active {
            background: var(--success-color);
        }

        .toggle-switch::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: all 0.3s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active::after {
            transform: translateX(24px);
        }

        .extension-actions {
            display: flex;
            gap: 6px;
            justify-content: space-between;
            margin-top: auto;
        }

        .extension-btn {
            flex: 1;
            padding: 8px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
            text-align: center;
        }

        .extension-btn:hover {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: var(--bg-primary);
        }

        /* å³å´é¢æ¿ */
        .right-panel {
            min-width: 320px;
            width: 320px;
            background: var(--sidebar-bg);
            border-left: 1px solid var(--border-color);
            padding: 24px;
            overflow-y: auto;
            flex-shrink: 0;
        }

        @media (max-width: 1200px) {
            .right-panel {
                min-width: 280px;
                width: 280px;
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .right-panel {
                width: 100%;
                min-width: 100%;
                border-left: none;
                border-top: 1px solid var(--border-color);
                padding: 16px;
            }
        }

        .panel-section {
            margin-bottom: 32px;
        }

        .panel-section h3 {
            font-size: 16px;
            margin-bottom: 16px;
            color: var(--text-primary);
            font-weight: 600;
        }

        .snapshot-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 14px;
            border-radius: 6px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .snapshot-item:hover {
            box-shadow: 0 2px 8px rgba(102, 217, 239, 0.2);
            border-color: var(--accent-color);
        }

        .snapshot-time {
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 4px;
            color: var(--text-primary);
        }

        .snapshot-meta {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .auto-snapshot-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            margin-bottom: 16px;
        }

        .auto-snapshot-toggle label {
            font-size: 14px;
            color: var(--text-primary);
            cursor: pointer;
        }


        /* å•ç­”ä»‹é¢ */
        .questionnaire {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .questionnaire.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .questionnaire-modal {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .questionnaire-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px 30px;
            color: white;
        }

        .questionnaire-body {
            padding: 30px;
        }

        .question-group {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .question-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .question-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }

        .options-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-item {
            display: flex;
            align-items: flex-start;
            padding: 12px;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-item:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .option-item.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .option-item input[type="radio"] {
            margin-right: 12px;
            margin-top: 3px;
        }

        .option-content {
            flex: 1;
        }

        .option-label {
            font-weight: 500;
            margin-bottom: 4px;
        }

        .option-desc {
            font-size: 12px;
            opacity: 0.8;
        }

        .recommended-badge {
            background: #4caf50;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            margin-left: 8px;
        }

        .text-input-group {
            margin-top: 15px;
        }

        .text-input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .text-input-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
        }

        .questionnaire-footer {
            padding: 20px 30px;
            background: #f8f9fa;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .copy-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .copy-btn:hover {
            opacity: 0.9;
        }

        .copy-success {
            color: #4caf50;
            font-size: 14px;
            display: none;
        }

        .copy-success.show {
            display: block;
        }

    </style>
</head>
<body data-theme="dark">
    <div class="container">
        <!-- é ‚éƒ¨å°èˆª -->
        <div class="header">
            <h1>ğŸ¯ Chrome æ“´å……åŠŸèƒ½ç®¡ç†å™¨</h1>
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showView('manager')">ç®¡ç†å™¨</button>
                <button class="nav-btn" onclick="showView('history')">æ­·å²è¨˜éŒ„</button>
                <button class="nav-btn" onclick="showView('settings')">è¨­å®š</button>
                <button class="nav-btn" onclick="showQuestionnaire()" style="background: #ff9800;">â“ å»ºç½®å•é¡Œ</button>
            </div>
        </div>

        <!-- ä¸»å…§å®¹å€ -->
        <div class="main-content">
            <!-- å·¦å´é‚Šæ¬„ - ç¾¤çµ„ -->
            <div class="sidebar">
                <h3>ç¾¤çµ„åˆ†é¡</h3>
                <ul class="group-list" id="groupList">
                    <li class="group-item active" data-group="all">
                        <span>æ‰€æœ‰æ“´å……åŠŸèƒ½</span>
                        <span class="count">43</span>
                    </li>
                    <li class="group-item" data-group="adblocker">
                        <span>ğŸ›¡ï¸ å»£å‘Šå°é–èˆ‡éš±ç§</span>
                        <span class="count">4</span>
                    </li>
                    <li class="group-item" data-group="ai">
                        <span>ğŸ¤– AIåŠ©æ‰‹èˆ‡èŠå¤©</span>
                        <span class="count">5</span>
                    </li>
                    <li class="group-item" data-group="productivity">
                        <span>ğŸ“Œ ç”Ÿç”¢åŠ›å·¥å…·</span>
                        <span class="count">7</span>
                    </li>
                    <li class="group-item" data-group="dev">
                        <span>ğŸ’» é–‹ç™¼å·¥å…·</span>
                        <span class="count">4</span>
                    </li>
                    <li class="group-item" data-group="screenshot">
                        <span>ğŸ“¸ æˆªåœ–èˆ‡è¤‡è£½</span>
                        <span class="count">4</span>
                    </li>
                    <li class="group-item" data-group="youtube">
                        <span>ğŸ¬ YouTubeå·¥å…·</span>
                        <span class="count">4</span>
                    </li>
                    <li class="group-item" data-group="translate">
                        <span>ğŸŒ ç¿»è­¯å·¥å…·</span>
                        <span class="count">2</span>
                    </li>
                    <li class="group-item" data-group="scraper">
                        <span>ğŸ” è³‡æ–™æŠ“å–</span>
                        <span class="count">3</span>
                    </li>
                    <li class="group-item" data-group="other">
                        <span>ğŸ”§ å…¶ä»–å·¥å…·</span>
                        <span class="count">10</span>
                    </li>
                </ul>
                <button class="add-group-btn" onclick="addGroup()">+ æ–°å¢ç¾¤çµ„</button>
            </div>

            <!-- ä¸­é–“å…§å®¹å€ -->
            <div class="content">
                <!-- æœå°‹å’Œéæ¿¾æ¬„ -->
                <div class="toolbar">
                    <div class="search-box">
                        <input type="text" placeholder="æœå°‹æ“´å……åŠŸèƒ½..." id="searchInput">
                    </div>
                    <button class="action-btn primary" onclick="createSnapshot()">ğŸ“¸ å»ºç«‹å¿«ç…§</button>
                </div>

                <!-- æ“´å……åŠŸèƒ½åˆ—è¡¨ -->
                <div class="extensions-grid" id="extensionsList">
                    <!-- å‹•æ…‹ç”Ÿæˆçš„æ“´å……åŠŸèƒ½å¡ç‰‡å°‡æ”¾é€™è£¡ -->
                </div>
            </div>

            <!-- å³å´é¢æ¿ -->
            <div class="right-panel">
                <!-- çµ±è¨ˆè³‡è¨Š -->
                <div class="panel-section">
                    <h3>ğŸ“Š çµ±è¨ˆè³‡è¨Š</h3>
                    <div style="background: var(--card-bg); border: 1px solid var(--border-color); padding: 16px; border-radius: 6px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                            <span style="color: var(--text-secondary);">ç¸½æ“´å……åŠŸèƒ½</span>
                            <strong id="totalCount" style="color: var(--text-primary);">43</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 12px;">
                            <span style="color: var(--text-secondary);">å·²å•Ÿç”¨</span>
                            <strong id="enabledCount" style="color: var(--success-color);">19</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: var(--text-secondary);">å·²åœç”¨</span>
                            <strong id="disabledCount" style="color: var(--warning-color);">24</strong>
                        </div>
                    </div>
                </div>

                <!-- æœ€è¿‘è®Šæ›´ -->
                <div class="panel-section">
                    <h3>ğŸ“ æœ€è¿‘è®Šæ›´</h3>
                    <div style="background: var(--card-bg); border: 1px solid var(--border-color); padding: 16px; border-radius: 6px;">
                        <div style="font-size: 13px; color: var(--text-secondary); line-height: 1.5;">
                            <div style="margin-bottom: 8px;">â€¢ 14:25 å•Ÿç”¨ Monica AIåŠ©æ‰‹</div>
                            <div style="margin-bottom: 8px;">â€¢ 14:20 åœç”¨ AdGuard</div>
                            <div style="margin-bottom: 8px;">â€¢ 13:45 å•Ÿç”¨ Dark Reader</div>
                            <div style="margin-bottom: 8px;">â€¢ 13:30 åœç”¨ YouTube Shorts</div>
                            <div style="margin-bottom: 8px;">â€¢ 13:15 å•Ÿç”¨ ç¯¡æ”¹çŒ´</div>
                        </div>
                        <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                            <button style="background: var(--bg-tertiary); border: 1px solid var(--border-color); padding: 6px 12px; border-radius: 4px; font-size: 12px; color: var(--text-secondary); cursor: pointer;">æŸ¥çœ‹æ‰€æœ‰è¨˜éŒ„</button>
                        </div>
                    </div>
                </div>

                <!-- å¿«ç…§è¨˜éŒ„ -->
                <div class="panel-section">
                    <h3>ğŸ“¸ å¿«ç…§è¨˜éŒ„</h3>
                    <div class="auto-snapshot-toggle">
                        <input type="checkbox" id="autoSnapshot" checked>
                        <label for="autoSnapshot">è‡ªå‹•æ¯æ—¥å¿«ç…§</label>
                    </div>
                    <div class="snapshot-item">
                        <div class="snapshot-time">ä»Šå¤© 14:30</div>
                        <div class="snapshot-meta">19å€‹å•Ÿç”¨ â€¢ æ‰‹å‹•å»ºç«‹</div>
                    </div>
                    <div class="snapshot-item">
                        <div class="snapshot-time">æ˜¨å¤© 23:59</div>
                        <div class="snapshot-meta">17å€‹å•Ÿç”¨ â€¢ è‡ªå‹•å¿«ç…§</div>
                    </div>
                    <div class="snapshot-item">
                        <div class="snapshot-time">2025/09/20 23:59</div>
                        <div class="snapshot-meta">20å€‹å•Ÿç”¨ â€¢ è‡ªå‹•å¿«ç…§</div>
                    </div>
                    
                    <!-- æ‰¹é‡æ§åˆ¶ - éš±è—åœ¨åº•éƒ¨ -->
                    <div style="margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border-color);">
                        <div style="display: flex; gap: 8px; justify-content: center;">
                            <button class="action-btn danger" onclick="confirmToggleGroup(false)" style="font-size: 11px; padding: 6px 10px; opacity: 0.7;">å…¨éƒ¨åœç”¨</button>
                            <button class="action-btn" onclick="confirmToggleGroup(true)" style="font-size: 11px; padding: 6px 10px; opacity: 0.7;">å…¨éƒ¨å•Ÿç”¨</button>
                        </div>
                        <small style="display: block; text-align: center; color: var(--text-secondary); margin-top: 4px; font-size: 10px;">æ‰¹é‡æ§åˆ¶ç•¶å‰ç¾¤çµ„</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å•ç­”ä»‹é¢ -->
    <div class="questionnaire" id="questionnaire">
        <div class="questionnaire-modal">
            <div class="questionnaire-header">
                <h2>å°ˆæ¡ˆå»ºç½®ç¢ºèªå•é¡Œ</h2>
                <p style="margin-top: 8px; opacity: 0.9;">è«‹å›ç­”ä»¥ä¸‹å•é¡Œï¼Œä»¥ä¾¿ç‚ºæ‚¨å»ºç«‹æœ€é©åˆçš„æ“´å……åŠŸèƒ½ç®¡ç†å™¨</p>
            </div>
            
            <div class="questionnaire-body">
                <!-- å•é¡Œ 1 -->
                <div class="question-group">
                    <div class="question-title">1. æ“´å……åŠŸèƒ½çš„å•Ÿå‹•æ–¹å¼åå¥½</div>
                    <div class="question-description">é¸æ“‡æ‚¨åå¥½çš„ç®¡ç†ä»‹é¢å•Ÿå‹•æ–¹å¼</div>
                    <div class="options-list">
                        <label class="option-item">
                            <input type="radio" name="q1" value="popup">
                            <div class="option-content">
                                <div class="option-label">Popup å½ˆå‡ºè¦–çª—</div>
                                <div class="option-desc">é»æ“Šå·¥å…·åˆ—åœ–ç¤ºé¡¯ç¤ºå°è¦–çª—ï¼Œå¿«é€Ÿæ“ä½œä½†ç©ºé–“æœ‰é™</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q1" value="tab" checked>
                            <div class="option-content">
                                <div class="option-label">ç¨ç«‹é é¢ <span class="recommended-badge">å»ºè­°</span></div>
                                <div class="option-desc">é–‹å•Ÿæ–°åˆ†é é¡¯ç¤ºå®Œæ•´ä»‹é¢ï¼Œç©ºé–“å……è¶³é©åˆè¤‡é›œç®¡ç†</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q1" value="both">
                            <div class="option-content">
                                <div class="option-label">å…©è€…å…¼å…·</div>
                                <div class="option-desc">Popup åšå¿«é€Ÿæ“ä½œï¼Œç¨ç«‹é é¢åšé€²éšç®¡ç†</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- å•é¡Œ 2 -->
                <div class="question-group">
                    <div class="question-title">2. ç¾¤çµ„ç®¡ç†çš„è¤‡é›œåº¦</div>
                    <div class="question-description">æ‚¨éœ€è¦å¤šè¤‡é›œçš„ç¾¤çµ„åŠŸèƒ½ï¼Ÿ</div>
                    <div class="options-list">
                        <label class="option-item">
                            <input type="radio" name="q2" value="simple">
                            <div class="option-content">
                                <div class="option-label">ç°¡å–®åˆ†é¡</div>
                                <div class="option-desc">å›ºå®šå¹¾å€‹é¡åˆ¥å³å¯</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q2" value="advanced" checked>
                            <div class="option-content">
                                <div class="option-label">é€²éšç¾¤çµ„ <span class="recommended-badge">å»ºè­°</span></div>
                                <div class="option-desc">è‡ªè¨‚ç¾¤çµ„ã€æ¨™ç±¤ã€å·¢ç‹€åˆ†é¡ã€æ‹–æ”¾æ’åº</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q2" value="tags">
                            <div class="option-content">
                                <div class="option-label">æ¨™ç±¤ç³»çµ±</div>
                                <div class="option-desc">ä¸€å€‹æ“´å……åŠŸèƒ½å¯å±¬æ–¼å¤šå€‹æ¨™ç±¤</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- å•é¡Œ 3 -->
                <div class="question-group">
                    <div class="question-title">3. è³‡æ–™å„²å­˜æ–¹å¼</div>
                    <div class="question-description">å¿«ç…§å’Œè¨­å®šè¦å„²å­˜åœ¨å“ªè£¡ï¼Ÿ</div>
                    <div class="options-list">
                        <label class="option-item">
                            <input type="radio" name="q3" value="local" checked>
                            <div class="option-content">
                                <div class="option-label">æœ¬æ©Ÿå„²å­˜ <span class="recommended-badge">å»ºè­°</span></div>
                                <div class="option-desc">ä½¿ç”¨ chrome.storage.localï¼Œç°¡å–®å¯é </div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q3" value="sync">
                            <div class="option-content">
                                <div class="option-label">åŒæ­¥å„²å­˜</div>
                                <div class="option-desc">ä½¿ç”¨ chrome.storage.syncï¼Œè·¨è¨­å‚™åŒæ­¥ä½†æœ‰å®¹é‡é™åˆ¶</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q3" value="hybrid">
                            <div class="option-content">
                                <div class="option-label">æ··åˆæ¨¡å¼</div>
                                <div class="option-desc">è¨­å®šåŒæ­¥ï¼Œå¿«ç…§æœ¬æ©Ÿï¼ˆé¿å…è¶…éåŒæ­¥é™åˆ¶ï¼‰</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- å•é¡Œ 4 -->
                <div class="question-group">
                    <div class="question-title">4. å¿«ç…§åŠŸèƒ½çš„è©³ç´°ç¨‹åº¦</div>
                    <div class="question-description">å¿«ç…§éœ€è¦è¨˜éŒ„å“ªäº›è³‡è¨Šï¼Ÿ</div>
                    <div class="options-list">
                        <label class="option-item">
                            <input type="radio" name="q4" value="basic">
                            <div class="option-content">
                                <div class="option-label">åŸºæœ¬å¿«ç…§</div>
                                <div class="option-desc">åªè¨˜éŒ„å•Ÿç”¨/åœç”¨ç‹€æ…‹</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q4" value="detailed" checked>
                            <div class="option-content">
                                <div class="option-label">è©³ç´°å¿«ç…§ <span class="recommended-badge">å»ºè­°</span></div>
                                <div class="option-desc">åŒ…å«ç‰ˆæœ¬ã€æ¬Šé™ã€ç¾¤çµ„é…ç½®ç­‰å®Œæ•´è³‡è¨Š</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q4" value="differential">
                            <div class="option-content">
                                <div class="option-label">å·®ç•°å¿«ç…§</div>
                                <div class="option-desc">åªè¨˜éŒ„èˆ‡ä¸Šæ¬¡çš„å·®ç•°ï¼Œç¯€çœç©ºé–“</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- å•é¡Œ 5 -->
                <div class="question-group">
                    <div class="question-title">5. UI è¦–è¦ºé¢¨æ ¼åå¥½</div>
                    <div class="question-description">æ‚¨åå¥½çš„ä»‹é¢é¢¨æ ¼æ˜¯ï¼Ÿ</div>
                    <div class="options-list">
                        <label class="option-item">
                            <input type="radio" name="q5" value="modern" checked>
                            <div class="option-content">
                                <div class="option-label">ç¾ä»£é¢¨æ ¼ <span class="recommended-badge">å»ºè­°</span></div>
                                <div class="option-desc">åœ“è§’ã€æ¼¸å±¤ã€é™°å½±ï¼Œè¦–è¦ºè±å¯Œ</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q5" value="minimal">
                            <div class="option-content">
                                <div class="option-label">æ¥µç°¡é¢¨æ ¼</div>
                                <div class="option-desc">ç°¡æ½”ç·šæ¢ã€å–®è‰²ç³»ã€æ³¨é‡åŠŸèƒ½</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q5" value="compact">
                            <div class="option-content">
                                <div class="option-label">ç·Šæ¹Šé¢¨æ ¼</div>
                                <div class="option-desc">è³‡è¨Šå¯†åº¦é«˜ï¼Œä¸€æ¬¡é¡¯ç¤ºæ›´å¤šå…§å®¹</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- å•é¡Œ 6ï¼šé–‹æ”¾å¼å•é¡Œ -->
                <div class="question-group">
                    <div class="question-title">6. å…¶ä»–ç‰¹æ®Šéœ€æ±‚</div>
                    <div class="question-description">è«‹æè¿°æ‚¨çš„ä»»ä½•ç‰¹æ®Šéœ€æ±‚æˆ–æƒ³æ³•ï¼ˆé¸å¡«ï¼‰</div>
                    <div class="text-input-group">
                        <textarea id="specialRequirements" placeholder="ä¾‹å¦‚ï¼š
- éœ€è¦åŒ¯å‡º/åŒ¯å…¥åŠŸèƒ½
- æƒ³è¦å¿«æ·éµæ”¯æ´
- éœ€è¦ç‰¹å®šçš„æ’åºæ–¹å¼
- æƒ³è¦æ·±è‰²æ¨¡å¼
- å…¶ä»–ä»»ä½•æƒ³æ³•..."></textarea>
                    </div>
                </div>

                <!-- å•é¡Œ 7 -->
                <div class="question-group">
                    <div class="question-title">7. æ¬Šé™ç®¡ç†é¡¯ç¤º</div>
                    <div class="question-description">æ˜¯å¦éœ€è¦é¡¯ç¤ºæ¯å€‹æ“´å……åŠŸèƒ½çš„æ¬Šé™é¢¨éšªç­‰ç´šï¼Ÿ</div>
                    <div class="options-list">
                        <label class="option-item">
                            <input type="radio" name="q7" value="yes" checked>
                            <div class="option-content">
                                <div class="option-label">éœ€è¦ <span class="recommended-badge">å»ºè­°</span></div>
                                <div class="option-desc">ç”¨é¡è‰²æ¨™è¨˜æ¬Šé™é¢¨éšªç­‰ç´šï¼ˆé«˜/ä¸­/ä½ï¼‰</div>
                            </div>
                        </label>
                        <label class="option-item">
                            <input type="radio" name="q7" value="no">
                            <div class="option-content">
                                <div class="option-label">ä¸éœ€è¦</div>
                                <div class="option-desc">åªé¡¯ç¤ºåŸºæœ¬è³‡è¨Šå³å¯</div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <div class="questionnaire-footer">
                <button class="nav-btn" onclick="closeQuestionnaire()">é—œé–‰</button>
                <span class="copy-success" id="copySuccess">âœ“ å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼</span>
                <button class="copy-btn" onclick="copyAnswers()">ğŸ“‹ ä¸€éµè¤‡è£½æ‰€æœ‰ç­”æ¡ˆ</button>
            </div>
        </div>
    </div>

    <script>
        // æ‚¨çš„å¯¦éš›æ“´å……åŠŸèƒ½è³‡æ–™
        const mockExtensions = [
            { id: 'ilmdofdhpnhffldihboadndccenlnfll', name: 'ChatGPT åŒ¯å‡ºå·¥å…·', version: '2.26.2', group: 'ai', enabled: false, icon: 'ğŸ’¾', description: 'ä¸‹è¼‰ ChatGPT å°è©±ç‚ºPDFã€Markdownã€æ–‡å­—ç­‰æ ¼å¼ã€‚', customDesc: 'ä¸‹è¼‰ ChatGPT å°è©±ç‚ºPDFã€Markdownã€æ–‡å­—ç­‰æ ¼å¼ã€‚' },
            { id: 'onpohiaebacahchaphmnehcnbjmamcbb', name: 'Coze Scraper', version: '2.0.2', group: 'scraper', enabled: false, icon: 'ğŸ•·ï¸', description: 'Scrape web pages and upload them to Coze Knowledge', customDesc: 'Scrape web pages and upload them to Coze Knowledge' },
            { id: 'jlmpjdjjbgclbocgajdjefcidcncaied', name: 'daily.dev | The homepage developers', version: '3.40.0', group: 'dev', enabled: false, icon: 'ğŸ“°', description: 'Get one personalized feed for all the knowledge you need as a developer.', customDesc: 'Get one personalized feed for all the knowledge you need as a developer.' },
            { id: 'eimadpbcbfnmbkopoojfekhnkhdbieeh', name: 'Dark Reader', version: '4.9.110', group: 'other', enabled: true, icon: 'ğŸŒ™', description: 'ç‚ºæ¯å€‹ç¶²ç«™æä¾›æ·±è‰²æ¨¡å¼ã€‚ä¿è­·æ‚¨çš„çœ¼ç›ï¼Œä½¿ç”¨ Dark Reader é€²è¡Œå¤œé–“å’Œæ—¥é–“ç€è¦½ã€‚', customDesc: 'ç‚ºæ¯å€‹ç¶²ç«™æä¾›æ·±è‰²æ¨¡å¼ã€‚ä¿è­·æ‚¨çš„çœ¼ç›ï¼Œä½¿ç”¨ Dark Reader é€²è¡Œå¤œé–“å’Œæ—¥é–“ç€è¦½ã€‚' },
            { id: 'fdpohaocaechififmbbbbbknoalclacl', name: 'GoFullPage - Full Page Screen Capture', version: '8.5', group: 'screenshot', enabled: true, icon: 'ğŸ“¸', description: 'å®Œæ•´å¯é åœ°æ•ç²ç•¶å‰é é¢çš„å±å¹•æˆªåœ– - ç„¡éœ€è«‹æ±‚ä»»ä½•é¡å¤–çš„æ¬Šé™ï¼', customDesc: 'å®Œæ•´å¯é åœ°æ•ç²ç•¶å‰é é¢çš„å±å¹•æˆªåœ– - ç„¡éœ€è«‹æ±‚ä»»ä½•é¡å¤–çš„æ¬Šé™ï¼' },
            { id: 'lpcaedmchfhocbbapmcbpinfpgnhiddi', name: 'Google Keep Chrome æ“´å……åŠŸèƒ½', version: '4.25372.540.1', group: 'productivity', enabled: false, icon: 'ğŸ“', description: 'åªè¦æŒ‰ä¸€ä¸‹ï¼Œå°±èƒ½å°‡å…§å®¹å„²å­˜åˆ° Google Keepï¼', customDesc: 'åªè¦æŒ‰ä¸€ä¸‹ï¼Œå°±èƒ½å°‡å…§å®¹å„²å­˜åˆ° Google Keepï¼' },
            { id: 'ghbmnnjooekpmoecnnnilnnbdlolhkhi', name: 'Google æ–‡ä»¶é›¢ç·šç‰ˆ', version: '1.96.1', group: 'productivity', enabled: true, icon: 'ğŸ“„', description: 'å³ä½¿åœ¨é›¢ç·šç‹€æ…‹ä¸‹ï¼Œä¹Ÿèƒ½ç·¨è¼¯ã€å»ºç«‹åŠç€è¦½æ–‡ä»¶ã€è©¦ç®—è¡¨å’Œç°¡å ±ã€‚', customDesc: 'å³ä½¿åœ¨é›¢ç·šç‹€æ…‹ä¸‹ï¼Œä¹Ÿèƒ½ç·¨è¼¯ã€å»ºç«‹åŠç€è¦½æ–‡ä»¶ã€è©¦ç®—è¡¨å’Œç°¡å ±ã€‚' },
            { id: 'aapbdbdomjkkjkaonfhkkikfgjllcleb', name: 'Google ç¿»è­¯', version: '2.0.16', group: 'translate', enabled: true, icon: 'ğŸŒ', description: 'ç€è¦½ç¶²é æ™‚å¯è¼•é¬†æŸ¥é–±ç¿»è­¯ç‰ˆæœ¬ã€‚Google ç¿»è­¯å°çµ„æä¾›ã€‚', customDesc: 'ç€è¦½ç¶²é æ™‚å¯è¼•é¬†æŸ¥é–±ç¿»è­¯ç‰ˆæœ¬ã€‚Google ç¿»è­¯å°çµ„æä¾›ã€‚' },
            { id: 'ofaokhiedipichpaobibbnahnkdoiiah', name: 'Instant Data Scraper', version: '1.2.1', group: 'scraper', enabled: false, icon: 'ğŸ”', description: 'Instant Data Scraper extracts data from web pages and exports it as Excel or CSV files', customDesc: 'Instant Data Scraper extracts data from web pages and exports it as Excel or CSV files' },
            { id: 'ophjlpahpchlmihnnnihgmmeilfjmjjc', name: 'LINE', version: '3.7.1', group: 'other', enabled: false, icon: 'ğŸ’¬', description: 'éš¨æ™‚éš¨åœ°å…è²»å‚³é€è¨Šæ¯', customDesc: 'éš¨æ™‚éš¨åœ°å…è²»å‚³é€è¨Šæ¯' },
            { id: 'nnifclicibdhgakebbnbfmomniihfmkg', name: 'Magic Copy', version: '1.2.0', group: 'screenshot', enabled: false, icon: 'âœ¨', description: "A Chrome extension to add a 'Magic Copy' option to the context menu, which copies selective parts of the image.", customDesc: "A Chrome extension to add a 'Magic Copy' option to the context menu, which copies selective parts of the image." },
            { id: 'memepciffhlkcckkmkbaccpmmfjjpdfg', name: 'Markdown for Google Keepâ„¢', version: '1.0.0', group: 'productivity', enabled: false, icon: 'âœï¸', description: 'Write and view Google Keep notes in Markdown.', customDesc: 'Write and view Google Keep notes in Markdown.' }
        ];

        let currentGroup = 'all';
        let extensions = [...mockExtensions];

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initTheme();
            renderExtensions();
            updateStatistics();
            initDragAndDrop();
            initGroupSelection();
            initSearch();
        });

        // æ¸²æŸ“æ“´å……åŠŸèƒ½åˆ—è¡¨
        function renderExtensions(filter = '') {
            const container = document.getElementById('extensionsList');
            let filteredExtensions = extensions;
            
            if (currentGroup !== 'all') {
                filteredExtensions = extensions.filter(ext => ext.group === currentGroup);
            }
            
            if (filter) {
                filteredExtensions = filteredExtensions.filter(ext => 
                    ext.name.toLowerCase().includes(filter.toLowerCase())
                );
            }

            container.innerHTML = filteredExtensions.map(ext => `
                <div class="extension-card" draggable="true" data-id="${ext.id}">
                    <div class="extension-toggle">
                        <div class="toggle-switch ${ext.enabled ? 'active' : ''}" 
                             onclick="toggleExtension('${ext.id}')"></div>
                    </div>
                    <div class="extension-header">
                        <div class="extension-icon">
                            <img src="chrome-extension://${ext.id}/icon.png" 
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div style="display:none; width:100%; height:100%; align-items:center; justify-content:center; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); border-radius: 8px; color: white; font-size: 20px;">${ext.icon}</div>
                        </div>
                        <div class="extension-info">
                            <div class="extension-name" title="${ext.name}">${ext.name}</div>
                            <div class="extension-meta" title="ç‰ˆæœ¬ ${ext.version}">v${ext.version}</div>
                        </div>
                    </div>
                    <div class="extension-description" 
                         contenteditable="true" 
                         onclick="editDescription('${ext.id}')" 
                         onblur="saveDescription('${ext.id}', this.textContent)" 
                         data-placeholder="é»æ“Šæ·»åŠ æè¿°...">${ext.customDesc || ext.description || 'é»æ“Šæ·»åŠ æè¿°...'}</div>
                    <div class="extension-actions">
                        <button class="extension-btn" onclick="openOptions('${ext.id}')" title="è¨­å®š">âš™ï¸</button>
                        <button class="extension-btn" onclick="showDetails('${ext.id}')" title="è©³æƒ…">ğŸ“Š</button>
                        <button class="extension-btn" onclick="uninstallExtension('${ext.id}')" title="å¸è¼‰">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `).join('');
        }

        // åˆ‡æ›æ“´å……åŠŸèƒ½ç‹€æ…‹
        function toggleExtension(id) {
            const ext = extensions.find(e => e.id === id);
            if (ext) {
                ext.enabled = !ext.enabled;
                renderExtensions();
                updateStatistics();
                logChange(`${ext.enabled ? 'å•Ÿç”¨' : 'åœç”¨'} ${ext.name}`);
            }
        }

        // æ›´æ–°çµ±è¨ˆè³‡è¨Š
        function updateStatistics() {
            const total = extensions.length;
            const enabled = extensions.filter(e => e.enabled).length;
            const disabled = total - enabled;
            
            const totalEl = document.getElementById('totalCount');
            const enabledEl = document.getElementById('enabledCount');
            const disabledEl = document.getElementById('disabledCount');
            
            if (totalEl) totalEl.textContent = total;
            if (enabledEl) enabledEl.textContent = enabled;
            if (disabledEl) disabledEl.textContent = disabled;
        }

        // ç¢ºèªæ‰¹é‡æ§åˆ¶
        function confirmToggleGroup(enable) {
            const action = enable ? 'å•Ÿç”¨' : 'åœç”¨';
            const groupName = currentGroup === 'all' ? 'æ‰€æœ‰æ“´å……åŠŸèƒ½' : document.querySelector('.group-item.active span').textContent;
            
            if (confirm(`ç¢ºå®šè¦${action}ã€Œ${groupName}ã€ä¸­çš„æ‰€æœ‰æ“´å……åŠŸèƒ½å—ï¼Ÿ\n\næ­¤æ“ä½œå°‡å½±éŸ¿å¤šå€‹æ“´å……åŠŸèƒ½çš„ç‹€æ…‹ã€‚`)) {
                toggleGroup(enable);
            }
        }

        // ç¾¤çµ„æ‰¹é‡æ§åˆ¶
        function toggleGroup(enable) {
            let targetExtensions = currentGroup === 'all' 
                ? extensions 
                : extensions.filter(ext => ext.group === currentGroup);
            
            let count = 0;
            targetExtensions.forEach(ext => {
                if (ext.enabled !== enable) {
                    ext.enabled = enable;
                    count++;
                }
            });
            
            renderExtensions();
            updateStatistics();
            logChange(`æ‰¹é‡${enable ? 'å•Ÿç”¨' : 'åœç”¨'}${count}å€‹æ“´å……åŠŸèƒ½`);
            
            if (count > 0) {
                alert(`å·²${enable ? 'å•Ÿç”¨' : 'åœç”¨'} ${count} å€‹æ“´å……åŠŸèƒ½`);
            }
        }

        // ç‹€æ…‹æ’åºï¼ˆå•Ÿç”¨çš„åœ¨å‰ï¼‰
        function sortByStatus() {
            extensions.sort((a, b) => {
                if (a.enabled === b.enabled) {
                    return a.name.localeCompare(b.name);
                }
                return b.enabled - a.enabled;
            });
            renderExtensions();
            logChange('æŒ‰ç‹€æ…‹æ’åº');
        }

        // åç¨±æ’åº
        function sortByName() {
            extensions.sort((a, b) => a.name.localeCompare(b.name));
            renderExtensions();
            logChange('æŒ‰åç¨±æ’åº');
        }

        // åˆå§‹åŒ–æ‹–æ”¾åŠŸèƒ½
        function initDragAndDrop() {
            let draggedElement = null;

            document.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('extension-card')) {
                    draggedElement = e.target;
                    e.target.classList.add('dragging');
                }
            });

            document.addEventListener('dragend', (e) => {
                if (e.target.classList.contains('extension-card')) {
                    e.target.classList.remove('dragging');
                }
            });

            document.addEventListener('dragover', (e) => {
                e.preventDefault();
                const container = document.getElementById('extensionsList');
                const afterElement = getDragAfterElement(container, e.clientY);
                if (draggedElement && afterElement == null) {
                    container.appendChild(draggedElement);
                } else if (draggedElement && afterElement) {
                    container.insertBefore(draggedElement, afterElement);
                }
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.extension-card:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // åˆå§‹åŒ–ç¾¤çµ„é¸æ“‡
        function initGroupSelection() {
            document.querySelectorAll('.group-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('.group-item').forEach(g => g.classList.remove('active'));
                    this.classList.add('active');
                    currentGroup = this.dataset.group;
                    
                    // æ›´æ–°ç¾¤çµ„åç¨±é¡¯ç¤º
                    const groupName = this.querySelector('span').textContent;
                    const nameElement = document.querySelector('#currentGroupName');
                    if (nameElement) {
                        nameElement.textContent = groupName;
                    }
                    
                    renderExtensions();
                });
            });
        }

        // åˆå§‹åŒ–æœå°‹
        function initSearch() {
            const searchInput = document.getElementById('searchInput');
            let timeout;
            
            searchInput.addEventListener('input', (e) => {
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    renderExtensions(e.target.value);
                }, 300);
            });
        }

        // æ–°å¢ç¾¤çµ„
        function addGroup() {
            const name = prompt('è«‹è¼¸å…¥ç¾¤çµ„åç¨±ï¼š');
            if (name) {
                const groupList = document.getElementById('groupList');
                const newGroup = document.createElement('li');
                newGroup.className = 'group-item';
                newGroup.dataset.group = name.toLowerCase().replace(/\s+/g, '_');
                newGroup.innerHTML = `
                    <span>${name}</span>
                    <span class="count">0</span>
                `;
                groupList.appendChild(newGroup);
                initGroupSelection();
                alert(`ç¾¤çµ„ "${name}" å·²å»ºç«‹ï¼`);
            }
        }

        // å»ºç«‹å¿«ç…§
        function createSnapshot() {
            const enabledCount = extensions.filter(e => e.enabled).length;
            const timestamp = new Date().toLocaleString('zh-TW');
            alert(`å¿«ç…§å·²å»ºç«‹ï¼\næ™‚é–“ï¼š${timestamp}\nå·²å•Ÿç”¨ï¼š${enabledCount} å€‹æ“´å……åŠŸèƒ½`);
            logChange('å»ºç«‹æ‰‹å‹•å¿«ç…§');
        }


        // é–‹å•Ÿè¨­å®šé 
        function openOptions(id) {
            const ext = extensions.find(e => e.id === id);
            if (ext) {
                alert(`é–‹å•Ÿ ${ext.name} çš„è¨­å®šé \n(å¯¦éš›ä½¿ç”¨æ™‚å°‡é–‹å•Ÿ chrome-extension://${id}/options.html)`);
                logChange(`é–‹å•Ÿ ${ext.name} è¨­å®šé `);
            }
        }

        // é¡¯ç¤ºè©³æƒ…
        function showDetails(id) {
            const ext = extensions.find(e => e.id === id);
            if (ext) {
                alert(`
æ“´å……åŠŸèƒ½è©³æƒ…ï¼š
åç¨±ï¼š${ext.name}
IDï¼š${ext.id}
ç‰ˆæœ¬ï¼š${ext.version}
ç‹€æ…‹ï¼š${ext.enabled ? 'å·²å•Ÿç”¨' : 'å·²åœç”¨'}
æè¿°ï¼š${ext.description}
ç¾¤çµ„ï¼š${ext.group}
                `);
            }
        }

        // å¸è¼‰æ“´å……åŠŸèƒ½
        function uninstallExtension(id) {
            const ext = extensions.find(e => e.id === id);
            if (ext && confirm(`ç¢ºå®šè¦å¸è¼‰ ${ext.name} å—ï¼Ÿ`)) {
                const index = extensions.indexOf(ext);
                extensions.splice(index, 1);
                renderExtensions();
                updateStatistics();
                alert(`å·²å¸è¼‰ ${ext.name}`);
                logChange(`å¸è¼‰ ${ext.name}`);
            }
        }

        // ç·¨è¼¯æè¿°
        function editDescription(id) {
            const descElement = event.target;
            descElement.classList.add('editing');
            descElement.focus();
            
            // é¸ä¸­æ‰€æœ‰æ–‡å­—
            const range = document.createRange();
            range.selectNodeContents(descElement);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
        }

        // ä¿å­˜æè¿°
        function saveDescription(id, newDesc) {
            const ext = extensions.find(e => e.id === id);
            if (ext && newDesc.trim() && newDesc !== 'é»æ“Šæ·»åŠ æè¿°...') {
                ext.customDesc = newDesc.trim();
                logChange(`æ›´æ–° ${ext.name} çš„æè¿°`);
            }
            event.target.classList.remove('editing');
        }

        // è¨˜éŒ„è®Šæ›´
        function logChange(action) {
            console.log(`[è®Šæ›´] ${new Date().toLocaleTimeString('zh-TW')} - ${action}`);
        }

        // é¡¯ç¤ºå•ç­”ä»‹é¢
        function showQuestionnaire() {
            document.getElementById('questionnaire').classList.add('show');
        }

        // é—œé–‰å•ç­”ä»‹é¢
        function closeQuestionnaire() {
            document.getElementById('questionnaire').classList.remove('show');
        }

        // è¤‡è£½ç­”æ¡ˆ
        function copyAnswers() {
            const answers = [];
            
            // æ”¶é›†é¸æ“‡é¡Œç­”æ¡ˆ
            for (let i = 1; i <= 7; i++) {
                if (i === 6) continue; // è·³éæ–‡å­—è¼¸å…¥é¡Œ
                
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                if (selected) {
                    const label = selected.closest('.option-item').querySelector('.option-label').textContent.replace(/\s*å»ºè­°\s*/, '').trim();
                    const question = selected.closest('.question-group').querySelector('.question-title').textContent;
                    answers.push(`${question}\nç­”æ¡ˆï¼š${label}`);
                }
            }
            
            // æ”¶é›†æ–‡å­—è¼¸å…¥ç­”æ¡ˆ
            const specialReq = document.getElementById('specialRequirements').value;
            if (specialReq) {
                answers.push(`6. å…¶ä»–ç‰¹æ®Šéœ€æ±‚\nç­”æ¡ˆï¼š${specialReq}`);
            }
            
            // çµ„åˆæ‰€æœ‰ç­”æ¡ˆ
            const fullText = `Chrome æ“´å……åŠŸèƒ½ç®¡ç†å™¨ - å»ºç½®å•é¡Œå›ç­”\n` +
                           `=====================================\n\n` +
                           answers.join('\n\n') +
                           `\n\n===================================\n` +
                           `å›ç­”æ™‚é–“ï¼š${new Date().toLocaleString('zh-TW')}`;
            
            // è¤‡è£½åˆ°å‰ªè²¼ç°¿
            navigator.clipboard.writeText(fullText).then(() => {
                const successMsg = document.getElementById('copySuccess');
                successMsg.classList.add('show');
                setTimeout(() => {
                    successMsg.classList.remove('show');
                }, 3000);
            }).catch(err => {
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–æ–‡å­—è¤‡è£½');
                console.error('è¤‡è£½å¤±æ•—:', err);
            });
        }

        // è¦–åœ–åˆ‡æ›
        function showView(view) {
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // éš±è—æ‰€æœ‰å…§å®¹å€å¡Š
            const content = document.querySelector('.content');
            
            switch(view) {
                case 'manager':
                    content.innerHTML = getManagerView();
                    initManagerView();
                    break;
                case 'history':
                    content.innerHTML = getHistoryView();
                    break;
                case 'settings':
                    content.innerHTML = getSettingsView();
                    break;
            }
            
            logChange(`åˆ‡æ›åˆ°${view}è¦–åœ–`);
        }

        // ç²å–ç®¡ç†å™¨è¦–åœ–
        function getManagerView() {
            return `
                <!-- çµ±ä¸€å·¥å…·æ¬„ -->
                <div class="toolbar">
                    <div class="search-box">
                        <input type="text" placeholder="æœå°‹æ“´å……åŠŸèƒ½..." id="searchInput">
                    </div>
                    <button class="filter-btn" onclick="sortByStatus()">ğŸ“Š ç‹€æ…‹æ’åº</button>
                    <button class="filter-btn" onclick="sortByName()">ğŸ”¤ åç¨±æ’åº</button>
                    <button class="action-btn primary" onclick="createSnapshot()">ğŸ“¸ å»ºç«‹å¿«ç…§</button>
                    <div style="margin-left: auto; font-size: 14px; color: #7f8c8d;">
                        ç›®å‰ç¾¤çµ„ï¼š<span id="currentGroupName">æ‰€æœ‰æ“´å……åŠŸèƒ½</span>
                    </div>
                </div>

                <!-- æ“´å……åŠŸèƒ½åˆ—è¡¨ -->
                <div class="extensions-grid" id="extensionsList">
                    <!-- å‹•æ…‹ç”Ÿæˆçš„æ“´å……åŠŸèƒ½å¡ç‰‡å°‡æ”¾é€™è£¡ -->
                </div>
            `;
        }

        // ç²å–æ­·å²è¨˜éŒ„è¦–åœ–
        function getHistoryView() {
            return `
                <div style="padding: 20px;">
                    <h2 style="margin-bottom: 24px; color: #2c3e50;">ğŸ“ è®Šæ›´æ­·å²è¨˜éŒ„</h2>
                    
                    <div style="background: white; border: 1px solid #e0e6ed; border-radius: 8px; padding: 20px;">
                        <div class="toolbar">
                            <input type="date" style="padding: 10px; border: 1px solid #e0e6ed; border-radius: 4px;">
                            <button class="filter-btn">ç¯©é¸æ—¥æœŸ</button>
                            <button class="action-btn">åŒ¯å‡ºè¨˜éŒ„</button>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <div class="history-item" style="border-bottom: 1px solid #f1f2f6; padding: 16px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong style="color: #2c3e50;">14:25</strong> 
                                        <span style="color: #27ae60;">å•Ÿç”¨</span> Monica AIåŠ©æ‰‹
                                    </div>
                                    <small style="color: #7f8c8d;">å‰›æ‰</small>
                                </div>
                            </div>
                            <div class="history-item" style="border-bottom: 1px solid #f1f2f6; padding: 16px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong style="color: #2c3e50;">14:20</strong> 
                                        <span style="color: #e74c3c;">åœç”¨</span> AdGuard å»£å‘Šå°é–å™¨
                                    </div>
                                    <small style="color: #7f8c8d;">5åˆ†é˜å‰</small>
                                </div>
                            </div>
                            <div class="history-item" style="border-bottom: 1px solid #f1f2f6; padding: 16px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong style="color: #2c3e50;">13:45</strong> 
                                        <span style="color: #27ae60;">å•Ÿç”¨</span> Dark Reader
                                    </div>
                                    <small style="color: #7f8c8d;">40åˆ†é˜å‰</small>
                                </div>
                            </div>
                            <div class="history-item" style="border-bottom: 1px solid #f1f2f6; padding: 16px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong style="color: #2c3e50;">13:30</strong> 
                                        <span style="color: #f39c12;">å»ºç«‹å¿«ç…§</span> æ‰‹å‹•å¿«ç…§ - 19å€‹å•Ÿç”¨
                                    </div>
                                    <small style="color: #7f8c8d;">55åˆ†é˜å‰</small>
                                </div>
                            </div>
                            <div class="history-item" style="padding: 16px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <strong style="color: #2c3e50;">13:15</strong> 
                                        <span style="color: #27ae60;">æ‰¹é‡å•Ÿç”¨</span> é–‹ç™¼å·¥å…·ç¾¤çµ„ (4å€‹æ“´å……åŠŸèƒ½)
                                    </div>
                                    <small style="color: #7f8c8d;">1å°æ™‚å‰</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ç²å–è¨­å®šè¦–åœ–
        function getSettingsView() {
            const currentTheme = document.body.getAttribute('data-theme') || 'dark';
            return `
                <div style="padding: 20px;">
                    <h2 style="margin-bottom: 24px; color: var(--text-primary);">âš™ï¸ æ“´å……åŠŸèƒ½ç®¡ç†å™¨è¨­å®š</h2>
                    
                    <div style="display: grid; gap: 24px;">
                        <!-- å¤–è§€è¨­å®š -->
                        <div style="background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px;">
                            <h3 style="margin-bottom: 16px; color: var(--text-primary);">å¤–è§€è¨­å®š</h3>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; color: var(--text-primary);">ä¸»é¡Œé¸æ“‡</label>
                                <select id="themeSelect" onchange="changeTheme(this.value)" style="padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 4px; background: var(--card-bg); color: var(--text-primary); width: 200px;">
                                    <option value="dark" ${currentTheme === 'dark' ? 'selected' : ''}>ğŸŒ™ Monokai æš—è‰²ä¸»é¡Œ</option>
                                    <option value="light" ${currentTheme === 'light' ? 'selected' : ''}>â˜€ï¸ æ˜äº®ä¸»é¡Œ</option>
                                </select>
                                <small style="display: block; color: var(--text-secondary); margin-top: 4px;">
                                    é¸æ“‡æ‚¨åå¥½çš„ä»‹é¢ä¸»é¡Œé¢¨æ ¼
                                </small>
                            </div>
                        </div>
                        
                        <!-- ä¸€èˆ¬è¨­å®š -->
                        <div style="background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px;">
                            <h3 style="margin-bottom: 16px; color: var(--text-primary);">ä¸€èˆ¬è¨­å®š</h3>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; gap: 12px; color: var(--text-primary);">
                                    <input type="checkbox" checked>
                                    <span>å•Ÿå‹•æ™‚è‡ªå‹•è¼‰å…¥ä¸Šæ¬¡çš„ç¾¤çµ„ç‹€æ…‹</span>
                                </label>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; gap: 12px; color: var(--text-primary);">
                                    <input type="checkbox" checked>
                                    <span>é¡¯ç¤ºæ“´å……åŠŸèƒ½ç‰ˆæœ¬è³‡è¨Š</span>
                                </label>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; gap: 12px; color: var(--text-primary);">
                                    <input type="checkbox">
                                    <span>ç·Šæ¹Šé¡¯ç¤ºæ¨¡å¼</span>
                                </label>
                            </div>
                        </div>
                        
                        <!-- å¿«ç…§è¨­å®š -->
                        <div style="background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px;">
                            <h3 style="margin-bottom: 16px; color: var(--text-primary);">å¿«ç…§è¨­å®š</h3>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; gap: 12px; color: var(--text-primary);">
                                    <input type="checkbox" checked>
                                    <span>è‡ªå‹•æ¯æ—¥å¿«ç…§</span>
                                </label>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; color: var(--text-primary);">å¿«ç…§ä¿ç•™å¤©æ•¸</label>
                                <select style="padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; width: 120px; background: var(--card-bg); color: var(--text-primary);">
                                    <option value="7">7å¤©</option>
                                    <option value="30" selected>30å¤©</option>
                                    <option value="90">90å¤©</option>
                                    <option value="0">æ°¸ä¹…ä¿ç•™</option>
                                </select>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <button class="action-btn primary">ç«‹å³æ¸…ç†èˆŠå¿«ç…§</button>
                            </div>
                        </div>
                        
                        <!-- åŒ¯å…¥åŒ¯å‡º -->
                        <div style="background: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 20px;">
                            <h3 style="margin-bottom: 16px; color: var(--text-primary);">å‚™ä»½èˆ‡é‚„åŸ</h3>
                            
                            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                <button class="action-btn">åŒ¯å‡ºè¨­å®š</button>
                                <button class="action-btn">åŒ¯å…¥è¨­å®š</button>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <button class="action-btn primary">åŒ¯å‡ºæ“´å……åŠŸèƒ½æ¸…å–®</button>
                                <small style="display: block; color: var(--text-secondary); margin-top: 4px;">
                                    å°‡ç›®å‰çš„æ“´å……åŠŸèƒ½ç‹€æ…‹åŒ¯å‡ºç‚ºJSONæ ¼å¼
                                </small>
                            </div>
                        </div>
                        
                        <!-- å±éšªæ“ä½œ -->
                        <div style="background: var(--card-bg); border: 1px solid var(--warning-color); border-radius: 8px; padding: 20px;">
                            <h3 style="margin-bottom: 16px; color: var(--warning-color);">å±éšªæ“ä½œ</h3>
                            
                            <div style="margin-bottom: 16px;">
                                <button class="action-btn danger">é‡ç½®æ‰€æœ‰è¨­å®š</button>
                                <small style="display: block; color: var(--text-secondary); margin-top: 4px;">
                                    é€™å°‡æ¸…é™¤æ‰€æœ‰è‡ªè¨‚è¨­å®šã€ç¾¤çµ„é…ç½®å’Œå¿«ç…§è¨˜éŒ„
                                </small>
                            </div>
                            
                            <div style="margin-bottom: 16px;">
                                <button class="action-btn danger">æ¸…é™¤æ‰€æœ‰å¿«ç…§</button>
                                <small style="display: block; color: var(--text-secondary); margin-top: 4px;">
                                    æ°¸ä¹…åˆªé™¤æ‰€æœ‰å·²å»ºç«‹çš„å¿«ç…§è¨˜éŒ„
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // åˆå§‹åŒ–ç®¡ç†å™¨è¦–åœ–
        function initManagerView() {
            renderExtensions();
            updateStatistics();
            initDragAndDrop();
            initSearch();
        }

        // ä¸»é¡Œåˆ‡æ›åŠŸèƒ½
        function changeTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('preferred-theme', theme);
            logChange(`åˆ‡æ›åˆ°${theme === 'dark' ? 'Monokaiæš—è‰²' : 'æ˜äº®'}ä¸»é¡Œ`);
        }

        // åˆå§‹åŒ–ä¸»é¡Œ
        function initTheme() {
            const savedTheme = localStorage.getItem('preferred-theme') || 'dark';
            document.body.setAttribute('data-theme', savedTheme);
        }

        // ç‚ºé¸é …æ·»åŠ é»æ“Šæ•ˆæœ
        document.querySelectorAll('.option-item').forEach(item => {
            item.addEventListener('click', function() {
                // ç§»é™¤åŒçµ„çš„å…¶ä»–é¸ä¸­ç‹€æ…‹
                const radio = this.querySelector('input[type="radio"]');
                const name = radio.name;
                document.querySelectorAll(`input[name="${name}"]`).forEach(input => {
                    input.closest('.option-item').classList.remove('selected');
                });
                
                // æ·»åŠ ç•¶å‰é¸ä¸­ç‹€æ…‹
                this.classList.add('selected');
            });
        });

        // åˆå§‹åŒ–é¸ä¸­ç‹€æ…‹
        document.querySelectorAll('input[type="radio"]:checked').forEach(input => {
            input.closest('.option-item').classList.add('selected');
        });
    </script>
</body>
</html>
